
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Momentum: The AFL Card Game</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; text-align: center; }
    .card { display: inline-block; margin: 5px; padding: 10px; border: 2px solid #333; border-radius: 8px; width: 100px; height: 130px; background: white; cursor: pointer; }
    .blue { border-color: darkblue; background: #eef; }
    .red { border-color: darkred; background: #fee; }
    .card-title { font-weight: bold; }
    .card-value { font-size: 1.2em; margin-top: 8px; }
    #hand, #chain { margin: 20px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>Momentum</h1>
  <div id="game">
    <h2>Your Hand</h2>
    <div id="hand"></div>
    <h2>Your Momentum Chain</h2>
    <div id="chain"></div>
    <p><button onclick="nextTurn()">End Turn</button></p>
  </div>
  <script>
    const allCards = [
      { name: "Handball", color: "blue", value: "+1" },
      { name: "Bounce", color: "red", value: "+1" },
      { name: "Kick", color: "blue", value: "+1" },
      { name: "Kick & Mark", color: "red", value: "+1" },
      { name: "Mark", color: "blue", value: "0" },
      { name: "Torp", color: "red", value: "+3" },
      { name: "Banana", color: "blue", value: "+3" },
      { name: "Tackle", color: "red", value: "-1" },
      { name: "Smother", color: "blue", value: "-1" },
      { name: "Tackle - HTB", color: "red", value: "Reset" },
      { name: "Intercept Mark", color: "blue", value: "Steal" }
    ];

    const players = [
      { hand: [], chain: [], actions: 3 },
      { hand: [], chain: [], actions: 3 },
      { hand: [], chain: [], actions: 3 },
      { hand: [], chain: [], actions: 3 }
    ];
    let currentPlayerIndex = 0;

    function drawCard() {
      return allCards[Math.floor(Math.random() * allCards.length)];
    }

    function setupGame() {
      players.forEach(player => {
        player.hand = Array.from({ length: 5 }, drawCard);
        player.chain = [];
        player.actions = 3;
      });
      updateUI();
    }

    function updateUI() {
      const handDiv = document.getElementById("hand");
      const chainDiv = document.getElementById("chain");
      const player = players[0];
      handDiv.innerHTML = "";
      chainDiv.innerHTML = "";
      player.hand.forEach((card, idx) => {
        const div = document.createElement("div");
        div.className = `card ${card.color}`;
        div.innerHTML = `<div class="card-title">${card.name}</div><div class="card-value">${card.value}</div>`;
        div.onclick = () => playCard(idx);
        handDiv.appendChild(div);
      });
      player.chain.forEach(card => {
        const div = document.createElement("div");
        div.className = `card ${card.color}`;
        div.innerHTML = `<div class="card-title">${card.name}</div>`;
        chainDiv.appendChild(div);
      });
    }

    function isMomentumCard(card) {
      return ["Handball", "Bounce", "Kick", "Kick & Mark", "Mark", "Torp", "Banana"].includes(card.name);
    }

    function isDefensiveCard(card) {
      return ["Tackle", "Smother", "Tackle - HTB", "Intercept Mark"].includes(card.name);
    }

    function playCard(cardIndex) {
      const card = players[0].hand[cardIndex];
      if (isMomentumCard(card)) {
        players[0].chain.push(card);
        players[0].actions--;
        players[0].hand.splice(cardIndex, 1);
      } else if (isDefensiveCard(card)) {
        let targetIndex = parseInt(prompt("Target player (1-3)?"));
        if (targetIndex > 0 && targetIndex < 4) {
          playDefenceCard(0, cardIndex, targetIndex);
        }
      }
      updateUI();
    }

    function playDefenceCard(playerIndex, cardIndex, targetIndex) {
      const card = players[playerIndex].hand[cardIndex];
      const chain = players[targetIndex].chain;
      const last = chain.at(-1);
      if (card.name === "Tackle" && last && ["Handball", "Bounce"].includes(last.name)) {
        chain.pop();
      } else if (card.name === "Smother" && last && ["Handball", "Kick"].includes(last.name)) {
        chain.pop();
      } else if (card.name === "Tackle - HTB" && chain.length > 0) {
        players[targetIndex].chain = [];
      } else if (card.name === "Intercept Mark" && last && last.name === "Kick") {
        players[playerIndex].chain.push(last);
        chain.pop();
      }
      players[playerIndex].hand.splice(cardIndex, 1);
      players[playerIndex].actions--;
      updateUI();
    }

    function aiTurn(playerIndex) {
      const ai = players[playerIndex];
      const human = players[0];
      const last = human.chain.at(-1);
      const defenceIdx = ai.hand.findIndex(card =>
        (card.name === "Tackle" && last && ["Handball", "Bounce"].includes(last.name)) ||
        (card.name === "Smother" && last && ["Handball", "Kick"].includes(last.name)) ||
        (card.name === "Tackle - HTB" && human.chain.length > 0) ||
        (card.name === "Intercept Mark" && last && last.name === "Kick")
      );
      if (defenceIdx !== -1) {
        playDefenceCard(playerIndex, defenceIdx, 0);
        return;
      }
      const momentumIdx = ai.hand.findIndex(isMomentumCard);
      if (momentumIdx !== -1) {
        ai.chain.push(ai.hand[momentumIdx]);
        ai.hand.splice(momentumIdx, 1);
        ai.actions--;
      }
    }

    function nextTurn() {
      currentPlayerIndex = (currentPlayerIndex + 1) % 4;
      if (currentPlayerIndex !== 0) {
        aiTurn(currentPlayerIndex);
        setTimeout(nextTurn, 500);
      } else {
        players[0].actions = 3;
        updateUI();
      }
    }

    setupGame();
  </script>
</body>
</html>
